# Feature 08: Tradução para Inglês (i18n)

## Contexto e Objetivo

**Prioridade:** 🟡 Média  
**Estimativa:** 4-6 horas  
**Tipo:** Internacionalização

Traduzir toda a UI para inglês e criar sistema simples de i18n para facilitar adição de novos idiomas no futuro.

## Requisitos Técnicos

### Dependências

Não requer dependências adicionais - sistema customizado e simples.

### Tecnologias

- TypeScript para type-safety
- Context API para estado global (opcional)
- LocalStorage para preferência de idioma

## Arquitetura e Design

### Estrutura do Sistema

```
i18n System
    ├── Translation Dictionaries
    │   ├── en.ts (English)
    │   └── pt-BR.ts (Portuguese - opcional)
    ├── Translation Function (t)
    ├── Language Context (React)
    └── Language Selector Component
```

### Fluxo de Tradução

```
Component needs text
    ↓
Call t('key')
    ↓
Look up in current language dictionary
    ↓
Return translated string
    ↓
Render in UI
```

## Arquivos a Criar

### 1. `src/lib/i18n.ts`

**Responsabilidade:** Sistema core de i18n.

```typescript
import { en } from './locales/en';
import { ptBR } from './locales/pt-BR';

export type Language = 'en' | 'pt-BR';
export type TranslationKey = keyof typeof en;

const translations = {
  en,
  'pt-BR': ptBR,
} as const;

let currentLanguage: Language = 'en';

// Carregar idioma do localStorage
if (typeof window !== 'undefined') {
  const saved = localStorage.getItem('language') as Language;
  if (saved && translations[saved]) {
    currentLanguage = saved;
  }
}

/**
 * Translation function
 * @param key - Translation key
 * @param params - Optional parameters for interpolation
 */
export const t = (key: TranslationKey, params?: Record<string, string | number>): string => {
  let text = translations[currentLanguage][key] || key;
  
  // Simple parameter interpolation
  if (params) {
    Object.entries(params).forEach(([key, value]) => {
      text = text.replace(`{{${key}}}`, String(value));
    });
  }
  
  return text;
};

/**
 * Get current language
 */
export const getCurrentLanguage = (): Language => currentLanguage;

/**
 * Set language
 */
export const setLanguage = (lang: Language): void => {
  currentLanguage = lang;
  if (typeof window !== 'undefined') {
    localStorage.setItem('language', lang);
  }
  // Trigger re-render (via event)
  window.dispatchEvent(new Event('languagechange'));
};

/**
 * Get all available languages
 */
export const getAvailableLanguages = (): { code: Language; name: string }[] => [
  { code: 'en', name: 'English' },
  { code: 'pt-BR', name: 'Português (BR)' },
];
```

---

### 2. `src/lib/locales/en.ts`

**Responsabilidade:** Dicionário de traduções em inglês.

```typescript
export const en = {
  // Common
  'app.name': 'StandupMate',
  'app.tagline': 'Your daily standup companion',
  
  // Navigation
  'nav.dashboard': 'Dashboard',
  'nav.tickets': 'Tickets',
  'nav.templates': 'Templates',
  'nav.reports': 'Reports',
  'nav.settings': 'Settings',
  
  // Actions
  'action.save': 'Save',
  'action.cancel': 'Cancel',
  'action.delete': 'Delete',
  'action.edit': 'Edit',
  'action.create': 'Create',
  'action.export': 'Export',
  'action.import': 'Import',
  'action.close': 'Close',
  'action.confirm': 'Confirm',
  'action.back': 'Back',
  'action.next': 'Next',
  'action.search': 'Search',
  'action.filter': 'Filter',
  'action.clear': 'Clear',
  
  // Tickets
  'tickets.title': 'Tickets',
  'tickets.create': 'New Ticket',
  'tickets.empty': 'No tickets yet',
  'tickets.empty.description': 'Create your first ticket to get started',
  'tickets.search.placeholder': 'Search tickets...',
  'tickets.filter.status': 'Filter by status',
  'tickets.filter.template': 'Filter by template',
  'tickets.count': '{{count}} ticket(s)',
  'tickets.selected': '{{count}} selected',
  'tickets.bulk.update': 'Bulk Update',
  'tickets.status.todo': 'To Do',
  'tickets.status.in_progress': 'In Progress',
  'tickets.status.blocked': 'Blocked',
  'tickets.status.done': 'Done',
  
  // Ticket Edit
  'ticket.edit.title': 'Edit Ticket',
  'ticket.edit.save': 'Save Ticket',
  'ticket.edit.delete': 'Delete Ticket',
  'ticket.edit.delete.confirm': 'Are you sure you want to delete this ticket?',
  'ticket.edit.unsaved': 'You have unsaved changes',
  'ticket.edit.mark_complete': 'Mark as Complete',
  'ticket.edit.start_working': 'Start Working',
  
  // Templates
  'templates.title': 'Templates',
  'templates.create': 'New Template',
  'templates.builder': 'Template Builder',
  'templates.empty': 'No templates yet',
  'templates.empty.description': 'Create your first template to get started',
  'templates.import': 'Import Template',
  'templates.export': 'Export Template',
  'templates.marketplace': 'Template Marketplace',
  
  // Template Builder
  'builder.title': 'Template Builder',
  'builder.add_section': 'Add Section',
  'builder.add_field': 'Add Field',
  'builder.section.title': 'Section Title',
  'builder.field.properties': 'Field Properties',
  'builder.field.label': 'Label',
  'builder.field.type': 'Type',
  'builder.field.required': 'Required',
  'builder.field.placeholder': 'Placeholder',
  'builder.field.validation': 'Validation',
  'builder.field.options': 'Options',
  'builder.preview': 'Preview',
  
  // Dashboard
  'dashboard.title': 'Dashboard',
  'dashboard.daily_standup': 'Daily Standup',
  'dashboard.metrics': 'Metrics',
  'dashboard.tickets.total': 'Total Tickets',
  'dashboard.tickets.active': 'Active Tickets',
  'dashboard.tickets.completed': 'Completed',
  'dashboard.tickets.blocked': 'Blocked',
  
  // Settings
  'settings.title': 'Settings',
  'settings.general': 'General',
  'settings.appearance': 'Appearance',
  'settings.backup': 'Backup & Restore',
  'settings.language': 'Language',
  'settings.theme': 'Theme',
  'settings.theme.light': 'Light',
  'settings.theme.dark': 'Dark',
  'settings.theme.system': 'System',
  'settings.backup.export': 'Export Database',
  'settings.backup.import': 'Import Database',
  'settings.backup.export.description': 'Download all your templates and tickets as JSON',
  'settings.backup.import.description': 'Replace all data with a backup file',
  'settings.backup.import.warning': 'This will permanently delete all existing data!',
  
  // Pomodoro
  'pomodoro.title': 'Pomodoro Timer',
  'pomodoro.start': 'Start',
  'pomodoro.pause': 'Pause',
  'pomodoro.resume': 'Resume',
  'pomodoro.reset': 'Reset',
  'pomodoro.skip': 'Skip',
  'pomodoro.status.idle': 'Ready to start',
  'pomodoro.status.working': 'Focus Time 🎯',
  'pomodoro.status.break': 'Break Time ☕',
  'pomodoro.status.paused': 'Paused ⏸️',
  'pomodoro.completed': 'Pomodoros completed: {{count}} 🍅',
  'pomodoro.notification.work_complete': 'Work session complete!',
  'pomodoro.notification.break_complete': 'Break complete!',
  
  // Implementation History
  'history.title': 'Implementation History',
  'history.add_entry': 'Add Entry',
  'history.date': 'Date',
  'history.notes': 'Notes',
  'history.empty': 'No implementation history yet',
  'history.empty.description': 'Click "Add Entry" to start tracking progress',
  
  // Validation Messages
  'validation.required': 'This field is required',
  'validation.min': 'Minimum {{min}} characters',
  'validation.max': 'Maximum {{max}} characters',
  'validation.email': 'Invalid email address',
  'validation.url': 'Invalid URL',
  
  // Toast Messages
  'toast.success.save': 'Saved successfully',
  'toast.success.delete': 'Deleted successfully',
  'toast.success.create': 'Created successfully',
  'toast.success.import': 'Imported successfully',
  'toast.success.export': 'Exported successfully',
  'toast.error.generic': 'Something went wrong',
  'toast.error.network': 'Network error. Please try again.',
  'toast.error.not_found': 'Not found',
  
  // Keyboard Shortcuts
  'shortcuts.title': 'Keyboard Shortcuts',
  'shortcuts.save': 'Save',
  'shortcuts.search': 'Search',
  'shortcuts.new': 'New Ticket',
  'shortcuts.close': 'Close',
} as const;
```

---

### 3. `src/lib/locales/pt-BR.ts` (Opcional)

**Responsabilidade:** Dicionário de traduções em português (opcional para manter compatibilidade).

```typescript
import { en } from './en';

export const ptBR: typeof en = {
  // Common
  'app.name': 'StandupMate',
  'app.tagline': 'Seu companheiro de daily standup',
  
  // Navigation
  'nav.dashboard': 'Dashboard',
  'nav.tickets': 'Tickets',
  'nav.templates': 'Templates',
  'nav.reports': 'Relatórios',
  'nav.settings': 'Configurações',
  
  // Actions
  'action.save': 'Salvar',
  'action.cancel': 'Cancelar',
  'action.delete': 'Excluir',
  'action.edit': 'Editar',
  'action.create': 'Criar',
  'action.export': 'Exportar',
  'action.import': 'Importar',
  'action.close': 'Fechar',
  'action.confirm': 'Confirmar',
  'action.back': 'Voltar',
  'action.next': 'Próximo',
  'action.search': 'Buscar',
  'action.filter': 'Filtrar',
  'action.clear': 'Limpar',
  
  // ... todas as outras keys traduzidas
  
  // (Implementar todas as keys do en.ts)
} as const;
```

---

### 4. `src/app/components/ui/language-selector.tsx`

**Responsabilidade:** Componente para trocar idioma.

```typescript
import React from 'react';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/app/components/ui/select';
import { getAvailableLanguages, getCurrentLanguage, setLanguage, type Language } from '@/lib/i18n';
import { Globe } from 'lucide-react';

export const LanguageSelector: React.FC = () => {
  const [currentLang, setCurrentLang] = React.useState<Language>(getCurrentLanguage());
  const languages = getAvailableLanguages();
  
  const handleChange = (lang: Language) => {
    setLanguage(lang);
    setCurrentLang(lang);
    // Force re-render of app
    window.location.reload();
  };
  
  return (
    <div className="flex items-center gap-2">
      <Globe className="h-4 w-4 text-muted-foreground" />
      <Select value={currentLang} onValueChange={handleChange}>
        <SelectTrigger className="w-[180px]">
          <SelectValue />
        </SelectTrigger>
        <SelectContent>
          {languages.map((lang) => (
            <SelectItem key={lang.code} value={lang.code}>
              {lang.name}
            </SelectItem>
          ))}
        </SelectContent>
      </Select>
    </div>
  );
};
```

## Arquivos a Editar

**TODOS os arquivos de componentes e páginas que contêm texto hardcoded:**

- `src/app/pages/DashboardPage.tsx`
- `src/app/pages/TicketsPage.tsx`
- `src/app/pages/TicketEditPage.tsx`
- `src/app/pages/TemplatesPage.tsx`
- `src/app/pages/TemplateBuilderPage.tsx`
- `src/app/pages/SettingsPage.tsx`
- `src/app/pages/ReportsPage.tsx`
- `src/app/components/layouts/NavMain.tsx`
- `src/app/components/layouts/AppSidebar.tsx`
- `src/app/components/ticket/TicketList.tsx`
- `src/app/components/ticket/TicketCard.tsx`
- `src/app/components/ticket/TicketFilters.tsx`
- `src/app/components/dashboard/*`
- E todos os outros componentes com texto

### Exemplo de Mudança

**Antes:**
```typescript
<Button>Create Ticket</Button>
```

**Depois:**
```typescript
import { t } from '@/lib/i18n';

<Button>{t('tickets.create')}</Button>
```

**Antes:**
```typescript
<h1>Dashboard</h1>
<p>Welcome to your daily standup assistant</p>
```

**Depois:**
```typescript
import { t } from '@/lib/i18n';

<h1>{t('dashboard.title')}</h1>
<p>{t('app.tagline')}</p>
```

## Plano de Implementação Detalhado

### Fase 1: Sistema Core de i18n (1h)

1. **Criar `src/lib/i18n.ts`**
   - Função `t()`
   - Funções de get/set language
   - Event system para mudanças

2. **Criar `src/lib/locales/en.ts`**
   - Mapear todas as strings do app
   - Organizar por contexto
   - ~200-300 keys

3. **Criar `LanguageSelector` component**
   - Dropdown de idiomas
   - Persistência em localStorage

### Fase 2: Traduzir Páginas Principais (2h)

4. **Traduzir `NavMain.tsx` e `AppSidebar.tsx`**
   - Navigation items
   - Tooltips

5. **Traduzir páginas:**
   - `DashboardPage.tsx`
   - `TicketsPage.tsx`
   - `TicketEditPage.tsx`
   - `TemplatesPage.tsx`
   - `SettingsPage.tsx`

### Fase 3: Traduzir Componentes (1.5h)

6. **Traduzir componentes de ticket:**
   - `TicketList.tsx`
   - `TicketCard.tsx`
   - `TicketFilters.tsx`
   - `BatchActions.tsx`

7. **Traduzir componentes de template:**
   - `TemplatePreview.tsx`
   - `ImportTemplateModal.tsx`
   - Etc.

8. **Traduzir componentes UI:**
   - `Empty.tsx`
   - `Spinner.tsx`
   - Etc.

### Fase 4: Validação e Refinamentos (1.5h)

9. **Adicionar language selector em Settings**
   - Integrar componente
   - Testar mudança de idioma

10. **Revisar todas as páginas**
    - Verificar strings faltantes
    - Adicionar keys missing

11. **Criar pt-BR.ts (opcional)**
    - Traduzir para português
    - Testar bilíngue

12. **Testes finais**
    - Trocar idioma em todas as páginas
    - Verificar edge cases
    - Verificar interpolação de parâmetros

## Estruturas de Dados

### Translation Dictionary Type

```typescript
type TranslationDictionary = {
  [key: string]: string;
};
```

### Language Config

```typescript
interface LanguageConfig {
  code: Language;
  name: string;
  flag?: string; // emoji ou path
  dir?: 'ltr' | 'rtl'; // para idiomas RTL no futuro
}
```

## Casos de Uso

### Caso 1: Usuário Troca Idioma

1. Usuário vai para Settings
2. Vê seletor de idioma
3. Troca de "English" para "Português"
4. App recarrega
5. Toda UI está em português
6. Preferência é salva em localStorage

### Caso 2: Primeira Visita

1. Usuário abre app pela primeira vez
2. App detecta idioma do browser (navigator.language)
3. Se disponível, usa idioma detectado
4. Senão, usa inglês como fallback

## Validação e Testes

### Checklist de Validação

- [ ] Sistema de i18n funciona
- [ ] Função `t()` retorna strings corretas
- [ ] Todas as páginas estão traduzidas
- [ ] Todos os componentes estão traduzidos
- [ ] Language selector funciona
- [ ] Idioma persiste no localStorage
- [ ] App recarrega ao trocar idioma
- [ ] Interpolação de parâmetros funciona
- [ ] Fallback para key funciona (se tradução não existe)
- [ ] Sem strings hardcoded restantes

### Checklist de Cobertura

**Páginas:**
- [ ] DashboardPage
- [ ] TicketsPage
- [ ] TicketEditPage
- [ ] TemplatesPage
- [ ] TemplateBuilderPage
- [ ] SettingsPage
- [ ] ReportsPage

**Componentes:**
- [ ] Navigation
- [ ] Tickets
- [ ] Templates
- [ ] Dashboard
- [ ] UI components
- [ ] Forms
- [ ] Modals
- [ ] Toast messages
- [ ] Empty states
- [ ] Error messages

## Possíveis Desafios e Soluções

### Desafio 1: Muitas Strings para Traduzir

**Problema:** App tem centenas de strings.

**Solução:**
- Fazer em fases (páginas principais primeiro)
- Usar script para extrair strings (opcional)
- Priorizar UI crítica

### Desafio 2: Strings Dinâmicas

**Problema:** Algumas strings têm partes dinâmicas.

**Solução:**
```typescript
// Com interpolação
t('tickets.count', { count: tickets.length })
// "5 ticket(s)"

// Pluralização simples
const key = count === 1 ? 'ticket.singular' : 'ticket.plural';
t(key, { count })
```

### Desafio 3: Re-render ao Trocar Idioma

**Problema:** Como forçar re-render de toda a app?

**Solução:**
```typescript
// Opção 1: Reload page (simples)
window.location.reload();

// Opção 2: Context + event (mais elegante)
const [, forceUpdate] = useReducer(x => x + 1, 0);
useEffect(() => {
  window.addEventListener('languagechange', forceUpdate);
  return () => window.removeEventListener('languagechange', forceUpdate);
}, []);
```

### Desafio 4: Type Safety

**Problema:** Garantir que keys existem.

**Solução:**
```typescript
// Usar type inference do TypeScript
export type TranslationKey = keyof typeof en;

export const t = (key: TranslationKey): string => {
  // TypeScript vai autocompletar e validar keys
};
```

## Exemplo de Hook Customizado (Opcional)

```typescript
// src/app/hooks/useTranslation.ts
import { useState, useEffect } from 'react';
import { t as translate, getCurrentLanguage, type TranslationKey } from '@/lib/i18n';

export const useTranslation = () => {
  const [, forceUpdate] = useState(0);
  
  useEffect(() => {
    const handler = () => forceUpdate(prev => prev + 1);
    window.addEventListener('languagechange', handler);
    return () => window.removeEventListener('languagechange', handler);
  }, []);
  
  const t = (key: TranslationKey, params?: Record<string, string | number>) => {
    return translate(key, params);
  };
  
  return {
    t,
    language: getCurrentLanguage(),
  };
};

// Uso:
const { t } = useTranslation();
<Button>{t('action.save')}</Button>
```

## Critérios de Aceite

- ✅ Toda UI está em inglês por padrão
- ✅ Sistema de i18n é simples e extensível
- ✅ Função `t()` funciona em todos os componentes
- ✅ Language selector funciona
- ✅ Idioma persiste entre sessões
- ✅ Sem strings hardcoded em português
- ✅ Type safety para translation keys
- ✅ Interpolação de parâmetros funciona
- ✅ Easy to add new languages
- ✅ Português opcional funciona (se implementado)

---

**Última atualização:** Janeiro 2025  
**Status:** Aguardando implementação

